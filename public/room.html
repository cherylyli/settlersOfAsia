<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Room</title>
    <link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900' rel='stylesheet' type='text/css'>
    <link href="/css/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="//res.wx.qq.com/open/libs/weui/1.1.1/weui.min.css" rel="stylesheet">
    <link href="/css/plugins/weui.min.css" rel="stylesheet">
    <link href="/css/plugins/animate.min.css" rel="stylesheet">
    <link href="/css/plugins/animate.css" rel="stylesheet">
    <link href="/css/plugins/sweetalert.css" rel="stylesheet">
    <link href="/css/plugins/rateyo.css" rel="stylesheet">
    <link href="/css/plugins/qtip.css" rel="stylesheet">
    <link href="/css/standard.css" rel="stylesheet">
    <link href="/css/board.css" rel="stylesheet">
    <link href="/css/room.css" rel="stylesheet">
    <!-- <link href="/css/lobby.css" rel="stylesheet"> -->
</head>

<body>
    <div id='page'>
        <div id='left-screen'>

                <div id='board' v-bind:disabled='!isMyTurn' class='box-shadow-light'>
                    <div class='map'></div>
                    <div class='dices'>
                        <div class='dice red'>
                            <div class='icon center-cropped'></div>
                            <div class='text'>{{ room.match ? room.match.dice.redDie : 'Not Rolled' }}</div>
                        </div>
                         <div class='dice yellow'>
                            <div class='icon center-cropped'></div>
                            <div class='text'>{{ room.match ? room.match.dice.yellowDie : 'Not Rolled' }}</div>
                        </div>
                         <div class='dice black'>
                            <div class='icon center-cropped'></div>
                            <div class='text'>{{ room.match ? startCase(Enum.DieResult(room.match.dice.eventDie)) : 'Not Rolled' }}</div>
                        </div>
                    </div>
                </div>


            <div id='utils' class='box-shadow-light'>
                <div class='me'>
                    <div class='pic center-cropped' v-bind:style='{backgroundImage:`url(${me.profile_pic})`}'>
                        <div class='name'>{{me.username}}</div>
                    </div>
                </div>
                <div class='common'>
                    <div class='dices'>
                        <div class='red dice center-contained unselectable turn-event' v-on:click='rollDice' v-bind:disabled='!isMyTurn'></div>
                        <div class='yellow dice center-contained unselectable turn-event' v-on:click='rollDice' v-bind:disabled='!isMyTurn'></div>
                        <div class='black dice center-contained unselectable turn-event' v-on:click='rollDice' v-bind:disabled='!isMyTurn'></div>
                    </div>
                    <div id='end-turn' class='ui-btn unselectable turn-event' v-bind:disabled='!isMyTurn' v-on:click='endTurn'><i class="fa fa-power-off" aria-hidden="true"></i>Finish</div>
                    <div id='trigger-cmd-table' class='ui-btn unselectable turn-event' v-bind:disabled='!isMyTurn'><i class="fa fa-bolt" aria-hidden="true"></i>Action</div>
                </div>
                <div class='cards'>
                    <div class='card' v-for='(count, resource) in my.resourcesAndCommodities' v-bind:class="[resource.toLowerCase()]">
                        <div class='border'></div>
                        <div class='name dot'>{{resource}}</div>
                        <div class='count'>{{count}}</div>
                    </div>
                   
                </div>

                <div class='mats'></div>
                <div class='improv'></div>
            </div>
        </div>
        <div id='right-screen' class='box-shadow-light'>
            <div id='users'>
                <!-- FIXME: some one plz help me fix this, match-div should not be in users div, but when i put it outside users div, the position of chat box is influenced, match-ops div overlaps the chat input box, and i cannot fix it-->
                <div id='match-state' class="weui-cells__title">Game State: {{room.state}}</div>
                <div v-for='player in room.users'>
                    <div class='user' v-bind:waiting='room.match && room.match.currentPlayer!=player.name' v-bind:data-username='player.name'>
                        <div class='pic center-cropped' v-bind:style='{backgroundImage:`url(${player.user.profile_pic})`}'>
                            <div class='name' v-bind:data-username='player.name'>{{player.user.username}}</div>
                        </div>
                        <ul class='info'>
                            <li>Metropolis: 0</li>
                            <li>Longest Road: {{player.longestRoad}}</li>
                            <li>Defender of Catan: 0</li>
                            <li>Progress Card: {{player.progressCardsCnt}}</li>
                            <li>VP: {{player.VP}}</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div id='log'>
                <div class='msgs'>
                    <div class='msg' v-for='log in logs'>
                        <span class='system'>{{ `${log.system ? '[SYSTEM]' : ''}` }}</span>
                        <span class='user' v-bind:class="{self: log.user == me.username}" v-if="log.user == me.username">{{ log.system ? 'You' : 'You:' }}</span>
                        <span class='user' v-else>{{ log.system ? (log.user || '') : (log.user ? log.user + ':' : '') }}</span>
                        <span class='action'>{{ `${log.action}` }}</span>
                    </div>
                </div>
                <input placeholder='Type a message...' v-on:keyup.enter='sendMessage'>
            </div>
            <div id='match-opts'>
                <div class='opt ui-btn' v-on:click='save'><i class="fa fa-hdd-o" aria-hidden="true"></i>Save</div>
                <div class='opt ui-btn' v-on:click='open'><i class="fa fa-folder-open-o" aria-hidden="true"></i>Open</div>
                <div class='opt ui-btn' v-on:click='quit'><i class="fa fa-sign-out" aria-hidden="true"></i>Quit</div>
            </div>
        </div>


        <div id="cmd-table" class="box-shadow-big ui-draggable">
            <div class="pop_title">
                <div class="pop_title_text">Perform an action</div>
                <div class="pop_close">
                    <div class="pop_close_img center-cropped"></div>
                </div>
            </div>
            <div class='wrap'>
                <div class="cmds">
                    <div class="cmd dot" v-for='command in cmds' v-bind:data-cmd="command">{{command | startCase}}</div>
                </div>
                <div class='ops'>
                    <div class="op" v-for='command in cmds' v-bind:data-cmd="command">

                        <!-- build establishment -->
                        <div v-if='command == "buildEstablishment"'>
                            <div class="weui-cells weui-cells_form" vertex-needed='1'>
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">Vertex ID</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='vertex'>
                                    </div>
                                </div>
                                <div class="weui-cell weui-cell_select weui-cell_select-after">
                                    <div class="weui-cell__hd"><label class="weui-label">Establishment</label></div>
                                    <div class="weui-cell__bd">
                                        <select class="weui-select" name='establishmentLV'>
                                            <option selected="" value="1">Settlement</option>
                                            <option value="2">City</option>
                                            <option value="3">Metropolitan</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- build road -->
                        <div v-else-if='command == "buildRoad"' vertex-needed='2'>
                            <div class="weui-cells weui-cells_form">
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">Vertex 1</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='vertex1'>
                                    </div>
                                </div>
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">Vertex 2</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='vertex2'>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- build ship -->
                        <div v-else-if='command == "buildShip"' vertex-needed='2'>
                            <div class="weui-cells weui-cells_form">
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">Vertex 1</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='vertex1'>
                                    </div>
                                </div>
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">Vertex 2</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='vertex2'>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- build city wall -->
                        <div v-else-if='command == "buildCityWall"' vertex-needed='1'>
                            <div class="weui-cells weui-cells_form">
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">Vertex</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='vertex'>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- build city improvement -->
                        <div v-else-if='command == "buyCityImprovement"'>
                            <div class="weui-cells weui-cells_form">
                                <div class="weui-cell weui-cell_select weui-cell_select-after">
                                    <div class="weui-cell__hd"><label class="weui-label">Category</label></div>
                                    <div class="weui-cell__bd">
                                        <select class="weui-select" name='category'>
                                            <option v-for='category in Enum.cityImprovementCategory' v-bind:value="category">{{category}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- move ship -->
                        <div v-else-if='command == "moveShip"'>
                            <div class="weui-cells weui-cells_form">
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">Old vertex 1</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='oldVertex1'>
                                    </div>
                                </div>
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">Old vertex 2</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='oldVertex2'>
                                    </div>
                                </div>
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">New vertex 1</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='newVertex1'>
                                    </div>
                                </div>
                                <div class="weui-cell">
                                    <div class="weui-cell__hd"><label class="weui-label">New vertex 2</label></div>
                                    <div class="weui-cell__bd">
                                        <input class="weui-input" type="number" pattern="[0-9]*" placeholder="Enter vertex ID" name='newVertex2'>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- trade with bank -->
                        <div v-else-if='command == "tradeWithBank"'>
                            <div class="weui-cells weui-cells_form">
                                <div class="weui-cell weui-cell_select weui-cell_select-after">
                                    <div class="weui-cell__hd"><label class="weui-label">Source</label></div>
                                    <div class="weui-cell__bd">
                                        <select class="weui-select" name='src'>
                                            <option v-for='item in Enum.Tradable' v-bind:value="item">{{item}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="weui-cell weui-cell_select weui-cell_select-after">
                                    <div class="weui-cell__hd"><label class="weui-label">Trade for</label></div>
                                    <div class="weui-cell__bd">
                                        <select class="weui-select" name='tradeFor'>
                                            <option v-for='item in Enum.Tradable' v-bind:value="item">{{item}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div v-else>didnt code this shit yet</div>
                        <div class='confirm ui-btn' v-on:click='call(command)'><i class="fa fa-check"></i> Confirm</div>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <script src="//unpkg.com/vue/dist/vue.js"></script>
    <script src="//cdn.jsdelivr.net/async/2.1.4/async.min.js"></script>
    <script src="/js/plugins/jquery.min.js"></script>
    <script src="/js/plugins/circular-json.js"></script>
    <script src="/js/plugins/jquery-ui.js"></script>
    <script src="/js/plugins/underscore.js"></script>
    <script src="/js/plugins/sweetalert.min.js"></script>
    <script src="/js/plugins/beautify.js"></script>
    <script src="/js/plugins/rateyo.jquery.js"></script>
    <script src="/js/plugins/qtip.js"></script>
    <script src="/js/plugins/wx.js"></script>
    <script src="/js/standard.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/plugins/socket-adapter.js"></script>
    <script src="/js/clientSideGameLogic/Enum.js"></script>
    <script src="/js/clientSideGameLogic/Cost.js"></script>
    <script src="/js/clientSideGameLogic/HexTile.js"></script>
    <script src="/js/clientSideGameLogic/Map.js"></script>
    <script src="/js/clientSideGameLogic/Commands.js"></script>
    <script src="/js/board.js"></script>
    <script src="/js/room.js"></script>
</body>
</html>